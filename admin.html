<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>John Power Memorial Darts Tournament - Admin</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f5f7fa;
    color: #333333;
    margin: 20px;
    padding-bottom: 40px;
  }
  h2 {
    color: #3aafa9;
    text-align: center;
    margin-bottom: 30px;
  }
  textarea {
    width: 100%;
    height: 100px;
    font-size: 1rem;
    padding: 10px;
    border: 2px solid #3aafa9;
    border-radius: 6px;
    box-sizing: border-box;
    resize: vertical;
    margin-bottom: 15px;
  }
  button {
    background-color: #3aafa9;
    color: white;
    border: none;
    padding: 12px 24px;
    font-size: 1rem;
    border-radius: 8px;
    cursor: pointer;
    margin: 5px 10px 20px 0;
    box-shadow: 0 4px 10px rgba(58, 175, 169, 0.5);
    transition: background-color 0.3s ease;
  }
  button:hover, button:focus {
    background-color: #2c8f8a;
  }
  .round {
    display: inline-block;
    vertical-align: top;
    margin-right: 20px;
    min-width: 220px;
  }
  .match {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }
  .player {
    padding: 6px;
    cursor: pointer;
    border-radius: 6px;
    margin-bottom: 6px;
    user-select: none;
    transition: background-color 0.2s ease;
  }
  .player:hover {
    background-color: #d0f0ef;
  }
  .winner {
    background-color: #3aafa9;
    color: white;
    font-weight: 700;
  }
  .board-input {
    width: 60px;
    margin-top: 6px;
    padding: 6px;
    border: 1px solid #3aafa9;
    border-radius: 6px;
    box-sizing: border-box;
  }
  input[type="text"].marker-input {
    margin-top: 6px;
    padding: 6px;
    border: 1px solid #3aafa9;
    border-radius: 6px;
    width: 100%;
    box-sizing: border-box;
  }
  @media (max-width: 768px) {
    .round {
      min-width: 150px;
      margin-right: 12px;
    }
    button {
      padding: 10px 18px;
      font-size: 0.9rem;
      margin: 5px 5px 15px 0;
    }
  }
  @media (max-width: 480px) {
    body {
      margin: 10px 12px;
    }
    .round {
      display: block;
      min-width: auto;
      margin-bottom: 20px;
    }
    button {
      width: 100%;
      margin-bottom: 15px;
    }
  }
</style>
</head>
<body>

<h2>John Power Memorial Darts Tournament - Admin</h2>
<a href="view.html" target="_blank" style="color:#3aafa9; display:block; text-align:center; margin-bottom:20px; font-weight:600;">ðŸ”— View Public Bracket</a>

<textarea id="players" placeholder="Enter one player per line..."></textarea><br />
<button id="generate">Generate Bracket</button>
<button id="reset">Clear All</button>
<button id="export">Export as PDF</button>

<div id="bracket"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// Full admin script here (same as before but trimmed for brevity)
function getPlayerName(player) { /*...*/ }
function saveBracket(data) { localStorage.setItem("bracket", JSON.stringify(data)); }
function loadBracket() { const data = localStorage.getItem("bracket"); return data ? JSON.parse(data) : null; }
function createBracket(players) { /*...*/ }
function autoAdvanceByes(rounds) { /*...*/ }
function propagateWinner(rounds, match, winnerName) { /*...*/ }
function setWinner(rounds, match, name) { /*...*/ }
function updateName(rounds, oldName, newName) { /*...*/ }
function render(rounds) { /*...*/ }
function generate() { /*...*/ }

document.getElementById("generate").onclick = generate;
document.getElementById("reset").onclick = () => {
  if (confirm("Clear all data?")) {
    localStorage.removeItem("bracket");
    document.getElementById("players").value = "";
    document.getElementById("bracket").innerHTML = "";
  }
};
document.getElementById("export").onclick = () => {
  html2canvas(document.getElementById("bracket")).then(canvas => {
    const imgData = canvas.toDataURL("image/png");
    const pdf = new jspdf.jsPDF();
    const imgProps = pdf.getImageProperties(imgData);
    const pdfWidth = pdf.internal.pageSize.getWidth();
    const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
    pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
    pdf.save("bracket.pdf");
  });
};
window.onload = () => {
  const saved = loadBracket();
  if (saved) render(saved);
};
</script>
</body>
</html>
